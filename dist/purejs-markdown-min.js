const MD_TYPE={REPLACE_ALL:"REPLACE_ALL",REPLACE_TAG:"REPLACE_TAG",CUSTOM_EDIT:"CUSTOM_EDIT"},MD_REGEX={h1:{mode:MD_TYPE.REPLACE_TAG,html:"h1",regex:/^ *#{1}( .+)/gm},h2:{mode:MD_TYPE.REPLACE_TAG,html:"h2",regex:/^ *#{2}( .+)/gm},h3:{mode:MD_TYPE.REPLACE_TAG,html:"h3",regex:/^ *#{3}( .+)/gm},h4:{mode:MD_TYPE.REPLACE_TAG,html:"h4",regex:/^ *#{4}( .+)/gm},h5:{mode:MD_TYPE.REPLACE_TAG,html:"h5",regex:/^ *#{5}( .+)/gm},h6:{mode:MD_TYPE.REPLACE_TAG,html:"h6",regex:/^ *#{6}( .+)/gm},h1_alt:{mode:MD_TYPE.REPLACE_TAG,html:"h1",regex:/(\S+.*)\n *\=+[ \n\r][^\S]/gm},h2_alt:{mode:MD_TYPE.REPLACE_TAG,html:"h2",regex:/(\S+.*)\n *\-+[ \n\r][^\S]/gm},hr1:{mode:MD_TYPE.REPLACE_ALL,html:"hr",regex:/^ *\*{3,}[ \n\r]*?/gm},hr2:{mode:MD_TYPE.REPLACE_ALL,html:"hr",regex:/^ *\_{3,}[ \n\r]*?/gm},hr3:{mode:MD_TYPE.REPLACE_ALL,html:"hr",regex:/^ *\-{3,}[ \n\r]*?/gm},i:{mode:MD_TYPE.REPLACE_TAG,html:"i",regex:/(?![^\*\S])\*([^\*\n\r]+[\n\r]?[^\*\n\r]+)\*(?=[^\*\S])/gm},i_alt:{mode:MD_TYPE.REPLACE_TAG,html:"i",regex:/(?![^_\S])_([^_\n\r]+[\n\r]?[^_\n\r]+)_(?=[^_\S])/gm},b:{mode:MD_TYPE.REPLACE_TAG,html:"b",regex:/(?![^\*\S])\*\*([^\*\n\r]+[\n\r]?[^\*\n\r]+)\*\*(?=[^\*\S])/gm},b_alt:{mode:MD_TYPE.REPLACE_TAG,html:"b",regex:/(?![^_\S])__([^_\n\r]+[\n\r]?[^_\n\r]+)__(?=[^_\S])/gm},s:{mode:MD_TYPE.REPLACE_TAG,html:"s",regex:/[^~\S]~~([^~\n\r]+[\n\r]?[^~\n\r]+)~~[^~\S]/gm},ul1:{mode:MD_TYPE.REPLACE_TAG,html:"li",regex:/\++ (.*)/gm},ul2:{mode:MD_TYPE.REPLACE_TAG,html:"li",regex:/\-+ (.*)/gm},ul3:{mode:MD_TYPE.REPLACE_TAG,html:"li",regex:/\*+ (.*)/gm},ol1:{mode:MD_TYPE.REPLACE_TAG,html:"li",regex:/[0-9]+\. (.*)/gm},ol2:{mode:MD_TYPE.REPLACE_TAG,html:"li",regex:/^ *[a-zA-z]\. (.*)/gm},code_inl:{mode:MD_TYPE.REPLACE_TAG,html:"code",regex:/`([^`\n\r]+)`/gm},code_ind:{mode:MD_TYPE.REPLACE_TAG,html:"code",regex:/\`{3}((.*)[\S\s]+?(.*))\`{3}/gm},a:{mode:MD_TYPE.CUSTOM_EDIT,html:"",regex:/(?<=[^!])\[(.*?)\]\((.*?)( "(.*)")?\)/gm},img:{mode:MD_TYPE.CUSTOM_EDIT,html:"",regex:/!\[(.*?)\]\((.*?)( "(.*)")?\)/gm},subsc:{mode:MD_TYPE.REPLACE_TAG,html:"sub",regex:/\^(.*)\^/gm},supsc:{mode:MD_TYPE.REPLACE_TAG,html:"sup",regex:/\~(.*)\~/gm},u:{mode:MD_TYPE.REPLACE_TAG,html:"u",regex:/[^\+\S]\+\+([^\+\n\r]+[\n\r]?[^\+\n\r]+)\+\+[^\+\S]/gm},mark:{mode:MD_TYPE.REPLACE_TAG,html:"mark",regex:/[^=\S]==([^=\n\r]+[\n\r]?[^=\n\r]+)==[^=\S]/gm}};function jConvertMarkdown(e=!0){let E=document.getElementsByClassName("pjs-markdown");for(let e=0;e<E.length;e++){let m=E[e],r=jMarkdownToHtml(m.innerHTML);m.innerHTML=r}}function jMarkdownToHtml(e,E=!0){let m=e,r={},_=Object.keys(MD_REGEX).length;for(let E=0;E<_;E++){let _=Object.keys(MD_REGEX)[E],l=MD_REGEX[_],t=[...e.matchAll(l.regex)],g=l.html;console.log(t);for(let e=0;e<t.length;e++)switch(console.log(`regex: [${l.regex}], mode: [${l.mode}], match: [${t[e][0]}]`),l.mode){case MD_TYPE.REPLACE_ALL:m=m.replaceAll(t[e][0],`<${g}>`);break;case MD_TYPE.REPLACE_TAG:let E=_.match(/h[1-2]_alt/gm);m=m.replaceAll(t[e][0],`<${g} ${E?'style="text-align: center;"':""}>${t[e][1]}</${g}>`);break;case MD_TYPE.CUSTOM_EDIT:m=jMarkdownCustomEdit(l,_,t[e],m,r)}}return m}function jMarkdownCustomEdit(e,E,m,r,_){if(E.match(/ul[1-3]/gm),E.match(/ol[1-2]/gm),"a"==E)return r.replaceAll(m[0],`<a href=#${m[2]} ${4==m.length?'title="'+m[4]+'"':""}>${m[1]}</a>`);if("img"==E)return r.replaceAll(m[0],`<img src="${m[2]}" alt=${m[1]} ${4==m.length?'title="'+m[4]+'"':""}></img>`);if("text_foot"==E){let e=0;return m[1]in _?e=_[m[1]]:_[m[1]]=_.length+1,r.replaceAll(m[0],`<sup><a href=#${m[1]}>[${e}]</a></sup>`)}if("foot_def"==E){let e=0;return m[1]in _?e=_[m[1]]:_[m[1]]=_.length+1,r.replaceAll(m[0],`<p id=${m[1]}>${e}. ${m[2]}</p>`)}return r}